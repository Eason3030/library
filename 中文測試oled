/*
 * OLED ä¸­æ–‡é¡¯ç¤ºæ¸¬è©¦ç¨‹å¼
 * ç”¨é€”ï¼šç¢ºèª U8g2 å‡½å¼åº«å’Œä¸­æ–‡å­—å‹å¯ä»¥æ­£å¸¸ä½¿ç”¨
 * ä½œè€…ï¼šæœ¨æŸµé«˜å·¥é›»å­ç§‘
 */

#include <Wire.h>
#include <U8g2lib.h>

// ============================================================================
// OLED åˆå§‹åŒ–
// ============================================================================
// æ–¹æ³• 1ï¼šç¡¬é«” I2Cï¼ˆå…ˆè©¦é€™å€‹ï¼‰
U8G2_SSD1306_128X64_NONAME_F_HW_I2C u8g2(U8G2_R0, /* reset=*/ U8X8_PIN_NONE);

// å¦‚æœæ–¹æ³• 1 æ²’ç•«é¢ï¼Œè¨»è§£æ‰ä¸Šé¢é‚£è¡Œï¼Œå–æ¶ˆä¸‹é¢é€™è¡Œçš„è¨»è§£ï¼š
// U8G2_SSD1306_128X64_NONAME_F_SW_I2C u8g2(U8G2_R0, /* clock=*/ SCL, /* data=*/ SDA, /* reset=*/ U8X8_PIN_NONE);

// ============================================================================
// Setup
// ============================================================================
void setup() {
  Serial.begin(115200);
  delay(500);
  
  Serial.println(F("========================================"));
  Serial.println(F("OLED ä¸­æ–‡é¡¯ç¤ºæ¸¬è©¦ç¨‹å¼"));
  Serial.println(F("========================================"));
  
  // åˆå§‹åŒ– OLED
  Serial.print(F("æ­£åœ¨åˆå§‹åŒ– OLED... "));
  u8g2.begin();
  Serial.println(F("å®Œæˆ"));
  
  // å•Ÿç”¨ UTF-8 æ”¯æ´ï¼ˆé—œéµï¼ï¼‰
  Serial.print(F("å•Ÿç”¨ UTF-8 ç·¨ç¢¼... "));
  u8g2.enableUTF8Print();
  Serial.println(F("å®Œæˆ"));
  
  Serial.println();
  
  // ========================================
  // æ¸¬è©¦ 1: åŸºæœ¬ä¸­æ–‡é¡¯ç¤º
  // ========================================
  Serial.println(F("ã€æ¸¬è©¦ 1ã€‘åŸºæœ¬ä¸­æ–‡é¡¯ç¤º"));
  Serial.println(F("OLED æ‡‰è©²é¡¯ç¤ºï¼šã€Œæ¸¬è©¦æˆåŠŸï¼ã€"));
  
  u8g2.clearBuffer();
  u8g2.setFont(u8g2_font_unifont_t_chinese1);
  u8g2.setCursor(0, 15);
  u8g2.print("æ¸¬è©¦æˆåŠŸï¼");
  u8g2.sendBuffer();
  
  delay(2000);
  
  // ========================================
  // æ¸¬è©¦ 2: å°ˆé¡Œå¸¸ç”¨å­—
  // ========================================
  Serial.println(F("ã€æ¸¬è©¦ 2ã€‘å°ˆé¡Œå¸¸ç”¨å­—"));
  Serial.println(F("OLED æ‡‰è©²é¡¯ç¤ºä¸‰è¡Œä¸­æ–‡"));
  
  u8g2.clearBuffer();
  u8g2.setFont(u8g2_font_unifont_t_chinese1);
  
  u8g2.setCursor(0, 15);
  u8g2.print("è…³è¸è»Šç³»çµ±");
  
  u8g2.setCursor(0, 30);
  u8g2.print("æ­¸ä½ä¸­...");
  
  u8g2.setCursor(0, 45);
  u8g2.print("é€Ÿåº¦ è§’åº¦");
  
  u8g2.sendBuffer();
  
  delay(3000);
  
  // ========================================
  // æ¸¬è©¦ 3: æ··åˆä¸­è‹±æ–‡
  // ========================================
  Serial.println(F("ã€æ¸¬è©¦ 3ã€‘æ··åˆä¸­è‹±æ–‡"));
  Serial.println(F("OLED æ‡‰è©²é¡¯ç¤ºä¸­æ–‡+æ•¸å­—"));
  
  u8g2.clearBuffer();
  u8g2.setFont(u8g2_font_unifont_t_chinese1);
  
  u8g2.setCursor(0, 15);
  u8g2.print("ç³»çµ±ç‰ˆæœ¬ 9.7");
  
  u8g2.setCursor(0, 30);
  u8g2.print("é€Ÿåº¦: 15 km/h");
  
  u8g2.setCursor(0, 45);
  u8g2.print("è§’åº¦: 10Â°");
  
  u8g2.sendBuffer();
  
  delay(3000);
  
  // ========================================
  // æ¸¬è©¦ 4: æ‰€æœ‰ä½ æœƒç”¨åˆ°çš„å­—
  // ========================================
  Serial.println(F("ã€æ¸¬è©¦ 4ã€‘æ‰€æœ‰å°ˆé¡Œç”¨å­—"));
  
  const char* testWords[] = {
    "ç³»çµ± å•Ÿå‹• ä¸­",
    "è…³è¸è»Š è¼”åŠ©",
    "æ­¸ä½ å®Œæˆ",
    "ä¸Šå‡ ä¸‹é™",
    "é€Ÿåº¦ è§’åº¦",
    "ä½æ–¼ ä¸Šé™",
    "ä½æ–¼ ä¸‹é™",
    "å®‰å…¨ æ¨¡å¼",
    "é™¤éŒ¯ è³‡è¨Š"
  };
  
  int numTests = sizeof(testWords) / sizeof(testWords[0]);
  
  for (int i = 0; i < numTests; i++) {
    u8g2.clearBuffer();
    u8g2.setFont(u8g2_font_unifont_t_chinese1);
    
    u8g2.setCursor(0, 20);
    u8g2.print("å­—å‹æ¸¬è©¦ ");
    u8g2.print(i + 1);
    u8g2.print("/");
    u8g2.print(numTests);
    
    u8g2.setCursor(0, 40);
    u8g2.print(testWords[i]);
    
    u8g2.sendBuffer();
    
    Serial.print(F("  é¡¯ç¤º: "));
    Serial.println(testWords[i]);
    
    delay(1500);
  }
  
  Serial.println();
  Serial.println(F("========================================"));
  Serial.println(F("éœæ…‹æ¸¬è©¦å®Œæˆï¼"));
  Serial.println(F("é€²å…¥å‹•æ…‹æ¸¬è©¦ï¼ˆæ¯ 0.5 ç§’æ›´æ–°ä¸€æ¬¡ï¼‰"));
  Serial.println(F("========================================"));
  
  delay(1000);
}

// ============================================================================
// Loop - å‹•æ…‹é¡¯ç¤ºæ¸¬è©¦
// ============================================================================
void loop() {
  static int counter = 0;
  static unsigned long lastUpdate = 0;
  
  if (millis() - lastUpdate >= 500) {
    lastUpdate = millis();
    
    u8g2.clearBuffer();
    
    // æ¨™é¡Œ
    u8g2.setFont(u8g2_font_unifont_t_chinese1);
    u8g2.setCursor(0, 12);
    u8g2.print("å‹•æ…‹æ¸¬è©¦");
    
    u8g2.drawLine(0, 14, 127, 14);
    
    // è¨ˆæ•¸å™¨ï¼ˆä¸­æ–‡ + æ•¸å­—ï¼‰
    u8g2.setCursor(0, 28);
    u8g2.print("è¨ˆæ•¸å™¨: ");
    
    u8g2.setFont(u8g2_font_10x20_tr);
    u8g2.setCursor(80, 28);
    u8g2.print(counter);
    
    // æ¨¡æ“¬ç‹€æ…‹
    u8g2.setFont(u8g2_font_unifont_t_chinese1);
    u8g2.setCursor(0, 44);
    
    if (counter % 4 == 0) {
      u8g2.print("ä¸Šå‡ä¸­");
    } else if (counter % 4 == 1) {
      u8g2.print("ä¸‹é™ä¸­");
    } else if (counter % 4 == 2) {
      u8g2.print("ä½æ–¼ä¸Šé™");
    } else {
      u8g2.print("ä½æ–¼ä¸‹é™");
    }
    
    // åº•éƒ¨è³‡è¨Š
    u8g2.setFont(u8g2_font_6x10_tr);
    u8g2.setCursor(0, 60);
    u8g2.print("Speed:");
    u8g2.print(counter % 30);
    u8g2.print("  Angle:");
    u8g2.print(counter % 15);
    
    u8g2.sendBuffer();
    
    // åºåˆ—åŸ è¼¸å‡º
    if (counter % 10 == 0) {
      Serial.print(F("[å‹•æ…‹æ¸¬è©¦] è¨ˆæ•¸: "));
      Serial.print(counter);
      Serial.print(F(" | å¦‚æœ OLED æŒçºŒæ›´æ–°ï¼Œä»£è¡¨æˆåŠŸï¼"));
      Serial.println();
    }
    
    counter++;
  }
}
```

---

## ğŸ¯ æ¸¬è©¦æ­¥é©Ÿ

### 1. **ä¸Šå‚³ç¨‹å¼**
- é¸æ“‡æ­£ç¢ºçš„æ¿å­ï¼šArduino Mega 2560
- é¸æ“‡æ­£ç¢ºçš„ COM port
- ä¸Šå‚³

### 2. **è§€å¯Ÿ OLED**

æ‡‰è©²ä¾åºé¡¯ç¤ºï¼š

**ç•«é¢ 1ï¼ˆ2 ç§’ï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ¸¬è©¦æˆåŠŸï¼        â”‚
â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç•«é¢ 2ï¼ˆ3 ç§’ï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚è…³è¸è»Šç³»çµ±        â”‚
â”‚æ­¸ä½ä¸­...         â”‚
â”‚é€Ÿåº¦ è§’åº¦         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç•«é¢ 3ï¼ˆ3 ç§’ï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç³»çµ±ç‰ˆæœ¬ 9.7      â”‚
â”‚é€Ÿåº¦: 15 km/h     â”‚
â”‚è§’åº¦: 10Â°         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç•«é¢ 4~12ï¼ˆæ¯å€‹ 1.5 ç§’ï¼‰ï¼š**
```
å­—å‹æ¸¬è©¦ 1/9
ç³»çµ± å•Ÿå‹• ä¸­

å­—å‹æ¸¬è©¦ 2/9
è…³è¸è»Š è¼”åŠ©
...ï¼ˆä¾åºæ¸¬è©¦æ‰€æœ‰å­—ï¼‰
```

**æœ€å¾Œé€²å…¥å‹•æ…‹æ¸¬è©¦ï¼ˆæ¯ 0.5 ç§’æ›´æ–°ï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚å‹•æ…‹æ¸¬è©¦          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚è¨ˆæ•¸å™¨: 5         â”‚
â”‚ä¸Šå‡ä¸­            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Speed:5  Angle:5  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. **æª¢æŸ¥åºåˆ—åŸ ç›£æ§å™¨**

æ‡‰è©²è¼¸å‡ºï¼š
```
========================================
OLED ä¸­æ–‡é¡¯ç¤ºæ¸¬è©¦ç¨‹å¼
========================================
æ­£åœ¨åˆå§‹åŒ– OLED... å®Œæˆ
å•Ÿç”¨ UTF-8 ç·¨ç¢¼... å®Œæˆ

ã€æ¸¬è©¦ 1ã€‘åŸºæœ¬ä¸­æ–‡é¡¯ç¤º
OLED æ‡‰è©²é¡¯ç¤ºï¼šã€Œæ¸¬è©¦æˆåŠŸï¼ã€
ã€æ¸¬è©¦ 2ã€‘å°ˆé¡Œå¸¸ç”¨å­—
OLED æ‡‰è©²é¡¯ç¤ºä¸‰è¡Œä¸­æ–‡
ã€æ¸¬è©¦ 3ã€‘æ··åˆä¸­è‹±æ–‡
OLED æ‡‰è©²é¡¯ç¤ºä¸­æ–‡+æ•¸å­—
ã€æ¸¬è©¦ 4ã€‘æ‰€æœ‰å°ˆé¡Œç”¨å­—
  é¡¯ç¤º: ç³»çµ± å•Ÿå‹• ä¸­
  é¡¯ç¤º: è…³è¸è»Š è¼”åŠ©
  é¡¯ç¤º: æ­¸ä½ å®Œæˆ
  ...

========================================
éœæ…‹æ¸¬è©¦å®Œæˆï¼
é€²å…¥å‹•æ…‹æ¸¬è©¦ï¼ˆæ¯ 0.5 ç§’æ›´æ–°ä¸€æ¬¡ï¼‰
========================================
[å‹•æ…‹æ¸¬è©¦] è¨ˆæ•¸: 0 | å¦‚æœ OLED æŒçºŒæ›´æ–°ï¼Œä»£è¡¨æˆåŠŸï¼
[å‹•æ…‹æ¸¬è©¦] è¨ˆæ•¸: 10 | å¦‚æœ OLED æŒçºŒæ›´æ–°ï¼Œä»£è¡¨æˆåŠŸï¼
...
```

---

## âœ… æ¸¬è©¦çµæœåˆ¤æ–·

### ğŸ‰ **æˆåŠŸçš„æ¨™æº–ï¼š**
- âœ… OLED é¡¯ç¤ºæ¸…æ™°çš„ä¸­æ–‡å­—
- âœ… æ²’æœ‰æ–¹æ¡†æˆ–äº‚ç¢¼
- âœ… å‹•æ…‹æ¸¬è©¦è¨ˆæ•¸å™¨æŒçºŒå¢åŠ 
- âœ… åºåˆ—åŸ æ²’æœ‰éŒ¯èª¤è¨Šæ¯

### âš ï¸ **å¦‚æœæœ‰å•é¡Œï¼š**

| ç¾è±¡ | è§£æ±ºæ–¹æ³• |
|-----|---------|
| **å®Œå…¨æ²’ç•«é¢** | 1. æª¢æŸ¥ I2C æ¥ç·š<br>2. æ”¹ç”¨è»Ÿé«” I2Cï¼ˆç¨‹å¼ç¢¼ç¬¬ 14 è¡Œå–æ¶ˆè¨»è§£ï¼‰|
| **é¡¯ç¤ºæ–¹æ¡†** | ç¢ºèªæœ‰åŸ·è¡Œ `enableUTF8Print()`<br>æª¢æŸ¥ Arduino IDE ç·¨ç¢¼è¨­å®š |
| **éƒ¨åˆ†å­—é¡¯ç¤ºä¸å‡ºä¾†** | æ­£å¸¸ï¼è©²å­—ä¸åœ¨å­—å‹æª”ä¸­<br>å¯ä»¥æ”¹ç”¨åŒç¾©è© |
| **ç·¨è­¯è¨˜æ†¶é«”ä¸è¶³** | ç¢ºèªä½¿ç”¨ Arduino Mega<br>ä¸æ˜¯ UNO |

---

## ğŸ“ å›å ±æ ¼å¼

æ¸¬è©¦å¾Œå›è¦†æˆ‘ï¼š

**âœ… å¦‚æœæˆåŠŸï¼š**
```
æ¸¬è©¦æˆåŠŸï¼
OLED é¡¯ç¤ºæ­£å¸¸ï¼Œæ²’æœ‰äº‚ç¢¼
æº–å‚™å¥½æ¥æ”¶å®Œæ•´ä¸­æ–‡ç‰ˆï¼
```

**âŒ å¦‚æœå¤±æ•—ï¼š**
```
æ¸¬è©¦å¤±æ•—
ç¾è±¡ï¼š[æè¿°ä½ çœ‹åˆ°çš„æƒ…æ³]
åºåˆ—åŸ è¨Šæ¯ï¼š[è²¼ä¸ŠéŒ¯èª¤è¨Šæ¯]

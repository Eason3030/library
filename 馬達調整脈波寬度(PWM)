// 定義腳位
const int hallSensorPin = 2; // 霍爾感測器連接到 Arduino 數位腳位 D2
const int relayPin = 1;      // 繼電器連接到 Arduino 數位腳位 D3

void setup() {
  // 設定霍爾感測器為輸入模式
  pinMode(hallSensorPin, INPUT);
  
  // 設定繼電器為輸出模式
  pinMode(relayPin, OUTPUT);

  // 程式開始時，確保繼電器是關閉的 (通常是輸出 HIGH 關閉)
  // 如果是低電位觸發的繼電器，輸出 HIGH 會讓它保持在非作動狀態
  digitalWrite(relayPin, HIGH);
  
  Serial.begin(9600);
  Serial.println("霍爾感測器繼電器控制啟動...");
}

void loop() {
  // 讀取霍爾感測器的狀態
  // 數位霍爾感測器在偵測到磁場時通常會輸出 LOW (0)
  int hallState = digitalRead(hallSensorPin);
  
  // 判斷是否偵測到磁場
  if (hallState == LOW) {
    // **偵測到磁場：啟動繼電器**
    // 對於低電位觸發的繼電器模組，輸出 LOW 會啟動繼電器
    digitalWrite(relayPin, LOW); 
    Serial.println("-> 磁場偵測到！繼電器作動 (負載開啟)。");
  } else {
    // **未偵測到磁場：關閉繼電器**
    // 對於低電位觸發的繼電器模組，輸出 HIGH 會關閉繼電器
    digitalWrite(relayPin, HIGH); 
    Serial.println("-> 未偵測到磁場。繼電器釋放 (負載關閉)。");
  }

  delay(100); // 稍微延遲一下，避免讀取速度太快
}